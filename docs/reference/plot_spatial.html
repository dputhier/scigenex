<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>XY scatter plot of Visium data with hexagonal spots. — plot_spatial • scigenex</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="XY scatter plot of Visium data with hexagonal spots. — plot_spatial"><meta property="og:description" content="Given a Seurat Spatial object, this function creates a scatter plot of the
spatial expression of a gene across spots, where the X and Y coordinates
represent the spatial location of spots and the color represents the
expression level of the gene. This function as been tested with visium
data at the moment. Defaut shape is hexagon."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scigenex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home"></span>

  </a>
</li>
<li>
  <a href="../articles/usage.html">1 - scRNA-seq guided tutorial</a>
</li>
<li>
  <a href="../articles/spatial.html">2 - Spatial transcriptomics guided tutorial</a>
</li>
<li>
  <a href="../articles/report.html">3 - Creating a bookdown report</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dputhier/scigenex/">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>XY scatter plot of Visium data with hexagonal spots.</h1>
    <small class="dont-index">Source: <a href="https://github.com/dputhier/scigenex/blob/HEAD/R/plot_spatial.R"><code>R/plot_spatial.R</code></a></small>
    <div class="hidden name"><code>plot_spatial.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Given a Seurat Spatial object, this function creates a scatter plot of the
spatial expression of a gene across spots, where the X and Y coordinates
represent the spatial location of spots and the color represents the
expression level of the gene. This function as been tested with visium
data at the moment. Defaut shape is hexagon.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_spatial</span><span class="op">(</span></span>
<span>  seurat_obj <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gene_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metadata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intensity_slot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"counts"</span>, <span class="st">"sct"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">""</span>,</span>
<span>  size_title <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  face_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plain"</span>, <span class="st">"italic"</span>, <span class="st">"bold"</span>, <span class="st">"bold.italic"</span><span class="op">)</span>,</span>
<span>  legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  barwidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  barheight <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  axis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pt_size <span class="op">=</span> <span class="fl">3.6</span>,</span>
<span>  pt_shape <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  pt_star <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stroke <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="colors_for_gradient.html">colors_for_gradient</a></span><span class="op">(</span><span class="st">"Ju1"</span><span class="op">)</span>,</span>
<span>  coord_flip <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-seurat-obj">seurat_obj<a class="anchor" aria-label="anchor" href="#arg-seurat-obj"></a></dt>
<dd><p>A Seurat object containing spatial expression data.</p></dd>


<dt id="arg-gene-name">gene_name<a class="anchor" aria-label="anchor" href="#arg-gene-name"></a></dt>
<dd><p>The name of the gene to plot.</p></dd>


<dt id="arg-metadata">metadata<a class="anchor" aria-label="anchor" href="#arg-metadata"></a></dt>
<dd><p>Provide the name of a metadata that will be used instead of genes (i.e. from
meta.data) slot of a seurat object.</p></dd>


<dt id="arg-intensity-slot">intensity_slot<a class="anchor" aria-label="anchor" href="#arg-intensity-slot"></a></dt>
<dd><p>The assay slot to use for the gene expression values.
Must be one of "sct", "counts", or "data". Default is "sct".</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>The title of the plot. Default is an empty string.</p></dd>


<dt id="arg-size-title">size_title<a class="anchor" aria-label="anchor" href="#arg-size-title"></a></dt>
<dd><p>The size of the title.</p></dd>


<dt id="arg-face-title">face_title<a class="anchor" aria-label="anchor" href="#arg-face-title"></a></dt>
<dd><p>Font face for the title. Possible values are “plain”, “italic”, “bold” and “bold.italic”.</p></dd>


<dt id="arg-legend">legend<a class="anchor" aria-label="anchor" href="#arg-legend"></a></dt>
<dd><p>Whether to display a legend for the color scale. Default is FALSE.</p></dd>


<dt id="arg-barwidth">barwidth<a class="anchor" aria-label="anchor" href="#arg-barwidth"></a></dt>
<dd><p>A numeric or a grid::unit() object specifying the width of the colourbar.
Default value is legend.key.width or legend.key.size in theme() or theme.</p></dd>


<dt id="arg-barheight">barheight<a class="anchor" aria-label="anchor" href="#arg-barheight"></a></dt>
<dd><p>A numeric or a grid::unit() object specifying the height of the colourbar.
Default value is legend.key.height or legend.key.size in theme() or theme.</p></dd>


<dt id="arg-axis">axis<a class="anchor" aria-label="anchor" href="#arg-axis"></a></dt>
<dd><p>Whether to display a axis for the color scale. Default is FALSE.</p></dd>


<dt id="arg-pt-size">pt_size<a class="anchor" aria-label="anchor" href="#arg-pt-size"></a></dt>
<dd><p>The size of the points in the plot. Default is 2.1.</p></dd>


<dt id="arg-pt-shape">pt_shape<a class="anchor" aria-label="anchor" href="#arg-pt-shape"></a></dt>
<dd><p>The shape of the points in the plot. Default is 16 (a circle).</p></dd>


<dt id="arg-pt-star">pt_star<a class="anchor" aria-label="anchor" href="#arg-pt-star"></a></dt>
<dd><p>A boolean. Whether to use ggstar shapes.</p></dd>


<dt id="arg-stroke">stroke<a class="anchor" aria-label="anchor" href="#arg-stroke"></a></dt>
<dd><p>The thickness of margin of points.</p></dd>


<dt id="arg-colours">colours<a class="anchor" aria-label="anchor" href="#arg-colours"></a></dt>
<dd><p>A vector of colors.</p></dd>


<dt id="arg-coord-flip">coord_flip<a class="anchor" aria-label="anchor" href="#arg-coord-flip"></a></dt>
<dd><p>Whether to flip coordinates.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A ggplot2 object containing the scatter plot.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="load_example_dataset.html">load_example_dataset</a></span><span class="op">(</span><span class="st">"7870305/files/lymph_node_tiny_2"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Dataset 7870305/files/lymph_node_tiny_2 was already loaded. </span>
<span class="r-in"><span><span class="fu">plot_spatial</span><span class="op">(</span>seurat_obj <span class="op">=</span> <span class="va">lymph_node_tiny_2</span>, gene_name <span class="op">=</span> <span class="st">"CCL22"</span>, intensity_slot<span class="op">=</span><span class="st">"data"</span>, pt_size<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Feature is not a factor. </span>
<span class="r-plt img"><img src="plot_spatial-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">plot_spatial</span><span class="op">(</span>seurat_obj <span class="op">=</span> <span class="va">lymph_node_tiny_2</span>, metadata <span class="op">=</span> <span class="st">"nCount_Spatial"</span>, pt_size<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Feature is not a factor. </span>
<span class="r-plt img"><img src="plot_spatial-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">hull</span> <span class="op">&lt;-</span> <span class="fu"><a href="display_hull.html">display_hull</a></span><span class="op">(</span><span class="va">lymph_node_tiny_2</span>, </span></span>
<span class="r-in"><span>        ident<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu">Seurat</span><span class="fu">::</span><span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/Idents.html" class="external-link">Idents</a></span><span class="op">(</span><span class="va">lymph_node_tiny_2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">7</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        delta<span class="op">=</span><span class="fl">1</span>, size_x<span class="op">=</span><span class="fl">3.4</span>, size_y<span class="op">=</span><span class="fl">3</span>, color<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Creating a dataframe to store output </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Creating a list of neighborhoods. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Looping over the points. </span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">plot_spatial</span><span class="op">(</span>seurat_obj <span class="op">=</span> <span class="va">lymph_node_tiny_2</span>, gene_name <span class="op">=</span> <span class="st">"VPREB3"</span>, intensity_slot<span class="op">=</span><span class="st">"data"</span>, pt_size<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> |-- INFO :  Feature is not a factor. </span>
<span class="r-in"><span><span class="va">p</span> <span class="op">+</span> <span class="va">hull</span></span></span>
<span class="r-plt img"><img src="plot_spatial-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by J. Bavais.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

